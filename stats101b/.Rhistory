?predict
predict(m3,data.frame(NETPRICE=15000,INSTITUTION_GROUP="bachelor"), interval = "confidence")
predict(m3,data.frame(NETPRICE=15000,INSTITUTION_GROUP="bachelor"), interval = "confidence", level=0.95)
summary(m3)
m4 <- lm(DEFAULT_RATE ~ MEDIAN_BORROWING + MEDIAN_PAYMENT + NETPRICE + GRAD_RATE, loans)
vif(m4)
library(alr3)
library(MASS)
require(leaps)
vif(m4)
head(loans)
pairs(loans[,c(7,9,11,12,13)])
pairs(loans[,c(7,9,11,12,13)])
pl1 <- pairs(loans[,c(7,9,11,12,13)])
dev.copy(png,'pairs.png')
pairs(loans[,c(7,9,11,12,13)])
dev.off()
loans$PERCENT_OF_PAYBACK  <- loans$MEDIAN_PAYMENT/loans$MEDIAN_BORROWING
m5 <- lm(DEFAULT_RATE ~ PERCENT_OF_PAYBACK + NETPRICE + GRAD_RATE, loans)
vif(m5)
?mmp
mmp(m5, DEFAULT_RATE~NETPRICE)
mmp(m5,  NETPRICE)
mmp(m5,  variable =NETPRICE)
mmp(m5)
mmps(m5)
?mmps
mmps(m5, ~. | NETPRICE)
mmps(m5, ~. | NETPRICE)
mmps(m5)
?mmps
mmps(m5,~ NETPRICE)
mmps(m5,DEFAUL_RATE ~ NETPRICE)
mmps(m5,~ NETPRICE)
mmps(m5,DEFAUL_RATE ~ NETPRICE)
mmps(m5,~ NETPRICE)
loans$NETPRICE
nrow(loans$NETPRICE)
nrow(loans$NETPRICE)
nrows(loans$NETPRICE)
nrow(loans)
count(loans)
length(loans)
length(loans$NETPRICE)
length(loans$DEFAULT_RATE)
mmps(m5)
mmps(m5)[1]
mmps(m5)[2]
mmps(m5, variable=NETPRICE)
mmps(m5, variable=loans$NETPRICE)
mmps(m5, ~.)
mmps(m5, ~ GRAD_RATE)
mmps(m5, GRAD_RATE)
mmps(m5, ~.|GRAD_RATE)
mmps(m5, ~|GRAD_RATE)
mmps(m5, | GRAD_RATE)
mmps(m5, ~. | GRAD_RATE)
?MMPS
?mmps
mmps(m5, ~ GRAD_RATE + PERCENTAGE_OF_PAYBACK + GRAD_RATE)
mmps(m5, ~ GRAD_RATE + PERCENTAGE_OF_PAYBACK + GRAD_RATE)
mmps(m5, DEFAULT_RATE ~ GRAD_RATE + PERCENTAGE_OF_PAYBACK + GRAD_RATE)
mmps(m5, DEFAULT_RATE ~ GRAD_RATE + PERCENTAGE_OF_PAYBACK + GRAD_RATE)
mmp(m1,NETPRICE)
m5 <- lm(DEFAULT_RATE ~ PERCENT_OF_PAYBACK + NETPRICE + GRAD_RATE, loans)
mmp(m1,NETPRICE)
mmp(m5,NETPRICE)
m5 <- lm(DEFAULT_RATE ~ PERCENT_OF_PAYBACK + NETPRICE + GRAD_RATE, loans)
m5 <- lm(DEFAULT_RATE ~ PERCENT_OF_PAYBACK + NETPRICE + GRAD_RATE, loans)
summary(m5)
mmp(m5,NETPRICE)
mmp(m5, netprice)
mmp(m5, GRAD_RATE)
library(as3)
library(al3)
library(alr3)
mmp(m5, GRAD_RATE)
mmp(m5, loans$GRAD_RATE)
mmp(m5, GRAD_RATE)
model <- lm(DEFAULT_RATE ~ PERCENT_OF_PAYBACK + NETPRICE + GRAD_RATE, loans)
model <- lm(DEFAULT_RATE ~ PERCENT_OF_PAYBACK + NETPRICE + GRAD_RATE, loans)
vif(model)
mmp(model, GRAD_RATE)
mmp(model, "GRAD_RATE")
mmp(model)
mmp(model)
mmp(model)
mmp(model)
mmp(model)
mmp(model, model$fitted.values)
mmp(model, NETPRICe)
mmp(model, NETPRICE)
mmp(model, model$terms$NETPRICE)
mmp(model)
mmps(model)
mmp(model, NETPRICE)
mmp(model, GRAD_RATE)
names(loans)
model
model$coefficients
model$coefficients
model$na.action
model$model
mmp(model, model$model$NETPRICE)
dev.copy(png,'marginal.png')
mmp(model, model$model$NETPRICE, xlab="NETPRICE")
dev.off()
m6 <- lm(DEFAULT_RATE ~ PERCENT_OF_PAYBACK + I(NETPRICE)^4 + GRAD_RATE, loans)
mmp(m6, m6$m6$NETPRICE, xlab="NETPRICE")
m6 <- lm(DEFAULT_RATE ~ PERCENT_OF_PAYBACK + I(NETPRICE)^4 + GRAD_RATE, loans)
mmp(m6, m6$m6$NETPRICE, xlab="NETPRICE")
m6 <- lm(DEFAULT_RATE ~ PERCENT_OF_PAYBACK + I(NETPRICE)^4 + GRAD_RATE, loans)
mmp(m6, m6$model$NETPRICE, xlab="NETPRICE")
m6 <- lm(DEFAULT_RATE ~ PERCENT_OF_PAYBACK + I(NETPRICE)^4 + GRAD_RATE, loans)
mmp(m6, m6$model$I(NETPRICE), xlab="NETPRICE")
m6 <- lm(DEFAULT_RATE ~ PERCENT_OF_PAYBACK + NETPRICE=I(NETPRICE)^4 + GRAD_RATE, loans)
loans$NETPRICE_t <- loans$NETPRICE^4
m6 <- lm(DEFAULT_RATE ~ PERCENT_OF_PAYBACK + NETPRICE_t + GRAD_RATE, loans)
mmp(m6, m6$model$NETPRICE_t, xlab="NETPRICE_t")
loans$NETPRICE_t <- loans$NETPRICE^2
m6 <- lm(DEFAULT_RATE ~ PERCENT_OF_PAYBACK + NETPRICE_t + GRAD_RATE, loans)
mmp(m6, m6$model$NETPRICE_t, xlab="NETPRICE_t")
m6 <- lm(DEFAULT_RATE ~ PERCENT_OF_PAYBACK + NETPRICE + GRAD_RATE, loans)
mmp(m6, m6$model$NETPRICE, xlab="NETPRICE_t")
summary(powerTransform(cbind(DEFAULT_RATE,PERCENT_OF_PAYBACK,NETPRICE,GRAD_RATE)~1,data=loans))
summary(powerTransform(cbind(DEFAULT_RATE+1,PERCENT_OF_PAYBACK,NETPRICE,GRAD_RATE)~1,data=loans))
summary(powerTransform(cbind(DEFAULT_RATE,PERCENT_OF_PAYBACK,NETPRICE,GRAD_RATE)~1,data=loans))
range(loans$DEFAULT_RATE)
min(loans$DEFAULT_RATE)
loans$DEFAULT_RATE
summary(powerTransform(cbind(DEFAULT_RATE+1,PERCENT_OF_PAYBACK+1,NETPRICE+1,GRAD_RATE+1)~1,data=loans))
loans$NETPRICE
loans$PERCENT_OF_PAYBACK
loans$GRAD_RATE
summary(powerTransform(cbind(DEFAULT_RATE+100,PERCENT_OF_PAYBACK+100,
NETPRICE+100,GRAD_RATE+100)~1,data=loans))
loans$NETPRICE_t <- loans$NETPRICE^.5
m6 <- lm(DEFAULT_RATE ~ PERCENT_OF_PAYBACK + NETPRICE_t + GRAD_RATE, loans)
mmp(m6, m6$model$NETPRICE_t, xlab="NETPRICE_t")
loans$NETPRICE_t <- loans$NETPRICE^2
m6 <- lm(DEFAULT_RATE ~ PERCENT_OF_PAYBACK + NETPRICE_t + GRAD_RATE, loans)
mmp(m6, m6$model$NETPRICE_t, xlab="NETPRICE_t")
loans$NETPRICE_t <- loans$NETPRICE^3
m6 <- lm(DEFAULT_RATE ~ PERCENT_OF_PAYBACK + NETPRICE_t + GRAD_RATE, loans)
mmp(m6, m6$model$NETPRICE_t, xlab="NETPRICE_t")
loans$NETPRICE_t <- loans$NETPRICE^-4
m6 <- lm(DEFAULT_RATE ~ PERCENT_OF_PAYBACK + NETPRICE_t + GRAD_RATE, loans)
mmp(m6, m6$model$NETPRICE_t, xlab="NETPRICE_t")
loans$NETPRICE_t <- loans$NETPRICE^-2
m6 <- lm(DEFAULT_RATE ~ PERCENT_OF_PAYBACK + NETPRICE_t + GRAD_RATE, loans)
mmp(m6, m6$model$NETPRICE_t, xlab="NETPRICE_t")
loans$NETPRICE_t <- loans$NETPRICE^2
m6 <- lm(DEFAULT_RATE ~ PERCENT_OF_PAYBACK + NETPRICE_t + GRAD_RATE, loans)
mmp(m6, m6$model$NETPRICE_t, xlab="NETPRICE_t")
loans$NETPRICE_t <- loans$NETPRICE^4
m6 <- lm(DEFAULT_RATE ~ PERCENT_OF_PAYBACK + NETPRICE_t + GRAD_RATE, loans)
mmp(m6, m6$model$NETPRICE_t, xlab="NETPRICE_t")
loans$NETPRICE_t <- loans$NETPRICE^5
m6 <- lm(DEFAULT_RATE ~ PERCENT_OF_PAYBACK + NETPRICE_t + GRAD_RATE, loans)
mmp(m6, m6$model$NETPRICE_t, xlab="NETPRICE_t")
loans$NETPRICE_t <- loans$NETPRICE^1.5
m6 <- lm(DEFAULT_RATE ~ PERCENT_OF_PAYBACK + NETPRICE_t + GRAD_RATE, loans)
mmp(m6, m6$model$NETPRICE_t, xlab="NETPRICE_t")
m6 <- lm(DEFAULT_RATE ~ PERCENT_OF_PAYBACK + I(NETPRICE)^2 + GRAD_RATE, loans)
m6 <- lm(DEFAULT_RATE ~ PERCENT_OF_PAYBACK + I(NETPRICE)^2 + GRAD_RATE, loans)
mmp(m6, m6$model$`I(NETPRICE)`, xlab="NETPRICE_t")
m6 <- lm(DEFAULT_RATE ~ PERCENT_OF_PAYBACK + I(NETPRICE)^4 + GRAD_RATE, loans)
mmp(m6, m6$model$`I(NETPRICE)`, xlab="NETPRICE_t")
m6 <- lm(DEFAULT_RATE ~ PERCENT_OF_PAYBACK + I(NETPRICE)^4 + GRAD_RATE, loans)
mmp(m6, m6$model$`I(NETPRICE)`, xlab="NETPRICE_t")
m6 <- lm(DEFAULT_RATE ~ PERCENT_OF_PAYBACK + I(NETPRICE)^100 + GRAD_RATE, loans)
mmp(m6, m6$model$`I(NETPRICE)`, xlab="NETPRICE_t")
mmps(m6)
m6 <- lm(DEFAULT_RATE ~ PERCENT_OF_PAYBACK + I(NETPRICE)^100 + GRAD_RATE, loans)
m6 <- lm(DEFAULT_RATE ~ PERCENT_OF_PAYBACK + I(NETPRICE^100) + GRAD_RATE, loans)
mmp(m6, m6$model$`I(NETPRICE)`, xlab="NETPRICE_t")
mmps(m6)
mmps(m5)
m6 <- lm(DEFAULT_RATE ~ PERCENT_OF_PAYBACK + I(NETPRICE^4) + GRAD_RATE, loans)
mmp(m6, m6$model$`I(NETPRICE)`, xlab="NETPRICE_t")
loans <- read.csv("vmshare/ucla/classes/fall_16/stats101a/datasets/wsj3.csv")
loans$PERCENT_OF_PAYBACK  <- loans$MEDIAN_PAYMENT/loans$MEDIAN_BORROWING
m6 <- lm(DEFAULT_RATE ~ PERCENT_OF_PAYBACK + I(NETPRICE^4) + GRAD_RATE, loans)
mmp(m6, m6$model$`I(NETPRICE)`, xlab="NETPRICE_t")
m6 <- lm(DEFAULT_RATE ~ PERCENT_OF_PAYBACK + I(NETPRICE^4) + GRAD_RATE, loans)
mmps(m6)
m6 <- lm(DEFAULT_RATE ~ PERCENT_OF_PAYBACK + I(NETPRICE^2) + GRAD_RATE, loans)
mmps(m6)
m6 <- lm(DEFAULT_RATE ~ PERCENT_OF_PAYBACK + I(NETPRICE^1/2) + GRAD_RATE, loans)
mmps(m6)
m6 <- lm(DEFAULT_RATE ~ PERCENT_OF_PAYBACK + log(NETPRICE) + GRAD_RATE, loans)
mmps(m6)
m6 <- lm(DEFAULT_RATE ~ PERCENT_OF_PAYBACK + log(NETPRICE+1) + GRAD_RATE, loans)
mmps(m6)
loans$NETPRICE
m6 <- lm(DEFAULT_RATE ~ PERCENT_OF_PAYBACK + log(NETPRICE+86) + GRAD_RATE, loans)
mmps(m6)
mmps(m5)
m5 <- lm(DEFAULT_RATE ~ PERCENT_OF_PAYBACK + NETPRICE + GRAD_RATE, loans)
mmps(m5)
m6 <- lm(DEFAULT_RATE ~ PERCENT_OF_PAYBACK + I(NETPRICE^2) + GRAD_RATE, loans)
mmps(m6)
m6 <- lm(DEFAULT_RATE ~ PERCENT_OF_PAYBACK + I(NETPRICE^-2) + GRAD_RATE, loans)
mmps(m6)
m6 <- lm(DEFAULT_RATE ~ PERCENT_OF_PAYBACK + I(NETPRICE^4) + GRAD_RATE, loans)
mmps(m6)
mmps(m6,xlim(0,.5e+19))
m6 <- lm(DEFAULT_RATE ~ PERCENT_OF_PAYBACK + I(NETPRICE^4) + GRAD_RATE, loans)
mmp(m6, m6$model$`I(NETPRICE)`, xlab="NETPRICE")
mmp(m6, m6$model$`I(NETPRICE^4)`, xlab="NETPRICE")
m6 <- lm(DEFAULT_RATE ~ PERCENT_OF_PAYBACK + I(NETPRICE^3) + GRAD_RATE, loans)
mmp(m6, m6$model$`I(NETPRICE^3)`, xlab="NETPRICE")
m6 <- lm(DEFAULT_RATE ~ PERCENT_OF_PAYBACK + I(NETPRICE^2.5) + GRAD_RATE, loans)
mmp(m6, m6$model$`I(NETPRICE^3)`, xlab="NETPRICE")
m6 <- lm(DEFAULT_RATE ~ PERCENT_OF_PAYBACK + I(NETPRICE^2.5) + GRAD_RATE, loans)
mmp(m6, m6$model$`I(NETPRICE^2.5)`, xlab="NETPRICE")
m6 <- lm(DEFAULT_RATE ~ PERCENT_OF_PAYBACK + I(NETPRICE^-1) + GRAD_RATE, loans)
mmp(m6, m6$model$`I(NETPRICE^2.5)`, xlab="NETPRICE")
m6 <- lm(DEFAULT_RATE ~ PERCENT_OF_PAYBACK + I(NETPRICE^-1) + GRAD_RATE, loans)
mmp(m6, m6$model$`I(NETPRICE^-1)`, xlab="NETPRICE")
m6 <- lm(DEFAULT_RATE ~ PERCENT_OF_PAYBACK + I(NETPRICE^.05) + GRAD_RATE, loans)
mmp(m6, m6$model$`I(NETPRICE^.05)`, xlab="NETPRICE")
m6 <- lm(DEFAULT_RATE ~ PERCENT_OF_PAYBACK + I(NETPRICE^.05) + GRAD_RATE, loans)
mmp(m6, m6$model$`I(NETPRICE^.05)`, xlab="NETPRICE")
m6 <- lm(DEFAULT_RATE ~ PERCENT_OF_PAYBACK + I(NETPRICE^.05) + GRAD_RATE, loans)
mmp(m6, m6$model$`I(NETPRICE^0.05)`, xlab="NETPRICE")
m6 <- lm(DEFAULT_RATE ~ PERCENT_OF_PAYBACK + I(NETPRICE^1) + GRAD_RATE, loans)
mmp(m6, m6$model$`I(NETPRICE^1)`, xlab="NETPRICE")
plot(m6)
m6 <- lm(DEFAULT_RATE ~ PERCENT_OF_PAYBACK + I(NETPRICE^4) + GRAD_RATE, loans)
plot(m6)
m6 <- lm(DEFAULT_RATE ~ PERCENT_OF_PAYBACK + I(NETPRICE^-4) + GRAD_RATE, loans)
plot(m6)
m6 <- lm(DEFAULT_RATE ~ PERCENT_OF_PAYBACK + I(NETPRICE^4) + I(NETPRICE^2) + GRAD_RATE, loans)
plot(m6)
mmps(m6)
m7 <- lm(DEFAULT_RATE~NETPRICE + GRAD_RATE + MEDIAN_BORROWING)
m7 <- lm(DEFAULT_RATE~NETPRICE + GRAD_RATE + MEDIAN_BORROWING, loans)
plot(m7)
plot(m7)
par(mfrow=c(2,2))
plot(m7)
inverseResponsePlot(m7)
loans$DEFAULT_RATE
m7 <- lm(DEFAULT_RATE+1~NETPRICE + GRAD_RATE + MEDIAN_BORROWING, loans)
inverseResponsePlot(m7)
par(mfrow=c(1,1))
inverseResponsePlot(m7)
loans$DEFAULT_RATE <- loans$DEFAULT_RATE+1
m7 <- lm(DEFAULT_RATE~NETPRICE + GRAD_RATE + MEDIAN_BORROWING, loans)
inverseResponsePlot(m7)
inverseResponsePlot(m7)
summary( powerTransform(
with( loans, cbind( DEFAULT_RATE, NETPRICE, GRAD_RATE, MEDIAN_BORROWING)) ~1))
loans$NETPRICE
loans$NETPRICE <= 0
loans$NETPRICE[loans$NETPRICE <= 0}
loans$NETPRICE[loans$NETPRICE <= 0]
loans$GRAD_RATE <= 0
loans$GRAD_RATE[loans$GRAD_RATE <= 0]
loans$MEDIAN_BORROWING[loans$MEDIAN_BORROWING <= 0]
with( loans, cbind( DEFAULT_RATE, NETPRICE+20747 , GRAD_RATE+1, MEDIAN_BORROWING)) ~1))
summary( powerTransform( with( loans, cbind( DEFAULT_RATE, NETPRICE+20747 , GRAD_RATE+1, MEDIAN_BORROWING)) ~1))
loans$NETPRICE <- loans$NETPRICE+20747
loans$GRAD_RATE <- loans$GRAD_RATE +1
summary( powerTransform( with( loans, cbind( DEFAULT_RATE, NETPRICE , GRAD_RATE, MEDIAN_BORROWING)) ~1))
inverseResponsePlot(m7)
dev.copy(png,'inverseResponsePlot.png')
inverseResponsePlot(m7)
dev.off()
m8 <- lm(sqrt(DEFAULT_RATE)~NETPRICE + GRAD_RATE + MEDIAN_BORROWING, loans)
par(mfrow=c(2,2))
plot(m8)
summary(m3)
m3 <- lm(DEFAULT_RATE ~ NETPRICE + INSTITUTION_GROUP,loans)
summary(m3)
summary(m3)
1-pf(0.0055,1,3387)
loans <- read.csv("vmshare/ucla/classes/fall_16/stats101a/datasets/wsj3.csv")
loans$PERCENT_OF_PAYBACK  <- loans$MEDIAN_PAYMENT/loans$MEDIAN_BORROWING
loans$DEFAULT_RATE <- loans$DEFAULT_RATE+1
loans$NETPRICE <- loans$NETPRICE+20747
loans$GRAD_RATE <- loans$GRAD_RATE +1
m7 <- lm(DEFAULT_RATE~NETPRICE + GRAD_RATE + MEDIAN_BORROWING, loans)
loans <- read.csv("vmshare/ucla/classes/fall_16/stats101a/datasets/wsj3.csv")
m5 <- lm(DEFAULT_RATE ~ PERCENT_OF_PAYBACK + NETPRICE + GRAD_RATE, loans)
loans$PERCENT_OF_PAYBACK  <- loans$MEDIAN_PAYMENT/loans$MEDIAN_BORROWING
m5 <- lm(DEFAULT_RATE ~ PERCENT_OF_PAYBACK + NETPRICE + GRAD_RATE, loans)
mmp(m5, m5$model$NETPRICE, xlab="NETPRICE")
library(alr3)
library(MASS)
require(leaps)
mmp(m5, m5$model$NETPRICE, xlab="NETPRICE")
m6 <- lm(DEFAULT_RATE ~ PERCENT_OF_PAYBACK + I(NETPRICE^2) + GRAD_RATE, loans)
mmp(m6, m6$model$`I(NETPRICE^2)` , xlab="NETPRICE")
m6 <- lm(DEFAULT_RATE ~ PERCENT_OF_PAYBACK + I(NETPRICE^4) + GRAD_RATE, loans)
mmp(m6, m6$model$`I(NETPRICE^4)` , xlab="NETPRICE")
mmp(m6, m6$model$`I(NETPRICE^4)` , xlab="NETPRICE", ylim = c(-100,100))
mmp(m6, m6$model$`I(NETPRICE^4)` , xlab="NETPRICE", ylim = c(-50,50))
mmp(m6, m6$model$`I(NETPRICE^4)` , xlab="NETPRICE")
mmp(m6, m6$model$`I(NETPRICE^4)` , xlab="NETPRICE", ylim = c(-40,70))
mmp(m6, m6$model$`I(NETPRICE^4)` , xlab="NETPRICE", ylim = c(-30,70))
m6 <- lm(DEFAULT_RATE ~ PERCENT_OF_PAYBACK + I(NETPRICE^3) + GRAD_RATE, loans)
mmp(m6, m6$model$`I(NETPRICE^3)` , xlab="NETPRICE", ylim = c(-30,70))
m6 <- lm(DEFAULT_RATE ~ PERCENT_OF_PAYBACK + I(NETPRICE^2.5) + GRAD_RATE, loans)
mmp(m6, m6$model$`I(NETPRICE^2.5)` , xlab="NETPRICE", ylim = c(-30,70))
m6 <- lm(DEFAULT_RATE ~ PERCENT_OF_PAYBACK + I(NETPRICE^1.5) + GRAD_RATE, loans)
mmp(m6, m6$model$`I(NETPRICE^1.5)` , xlab="NETPRICE", ylim = c(-30,70))
m6 <- lm(DEFAULT_RATE ~ PERCENT_OF_PAYBACK + I(NETPRICE^1.2) + GRAD_RATE, loans)
mmp(m6, m6$model$`I(NETPRICE^1.5)` , xlab="NETPRICE", ylim = c(-30,70))
m6 <- lm(DEFAULT_RATE ~ PERCENT_OF_PAYBACK + I(NETPRICE^1.2) + GRAD_RATE, loans)
mmp(m6, m6$model$`I(NETPRICE^1.2)` , xlab="NETPRICE", ylim = c(-30,70))
m6 <- lm(DEFAULT_RATE ~ PERCENT_OF_PAYBACK + I(NETPRICE^1.3) + GRAD_RATE, loans)
mmp(m6, m6$model$`I(NETPRICE^1.3)` , xlab="NETPRICE", ylim = c(-30,70))
m6 <- lm(DEFAULT_RATE ~ PERCENT_OF_PAYBACK + I(NETPRICE^1.6) + GRAD_RATE, loans)
mmp(m6, m6$model$`I(NETPRICE^1.6)` , xlab="NETPRICE", ylim = c(-30,70))
m6 <- lm(DEFAULT_RATE ~ PERCENT_OF_PAYBACK + I(NETPRICE^1.5) + GRAD_RATE, loans)
mmp(m6, m6$model$`I(NETPRICE^1.5)` , xlab="NETPRICE", ylim = c(-30,70))
m6 <- lm(DEFAULT_RATE ~ PERCENT_OF_PAYBACK + I(NETPRICE^1.7) + GRAD_RATE, loans)
mmp(m6, m6$model$`I(NETPRICE^1.7)` , xlab="NETPRICE", ylim = c(-30,70))
m6 <- lm(DEFAULT_RATE ~ PERCENT_OF_PAYBACK + I(NETPRICE^1.8) + GRAD_RATE, loans)
mmp(m6, m6$model$`I(NETPRICE^1.8)` , xlab="NETPRICE", ylim = c(-30,70))
m6 <- lm(DEFAULT_RATE ~ PERCENT_OF_PAYBACK + I(NETPRICE^1.5) + GRAD_RATE, loans)
mmp(m6, m6$model$`I(NETPRICE^1.5)` , xlab="NETPRICE", ylim = c(-30,70))
dev.copy(png,'modifiedmmps.png')
mmp(m6, m6$model$`I(NETPRICE^1.5)` , xlab="NETPRICE", ylim = c(-30,70))
dev.off()
m7 <- lm(DEFAULT_RATE~NETPRICE + GRAD_RATE + MEDIAN_BORROWING, loans)
plot(m7)
m8 <- lm(sqrt(DEFAULT_RATE)~NETPRICE + GRAD_RATE + MEDIAN_BORROWING, loans)
plot(m8)
mmps(m7)
mmp(m7)
dev.copy(png,'mmps_untrasforned_p5.png')
mmp(m7)
dev.off()
m8 <- lm(sqrt(DEFAULT_RATE)~NETPRICE + GRAD_RATE + MEDIAN_BORROWING, loans)
dev.copy(png,'mmps_trasforned_p5.png')
mmp(m8)
dev.off()
form1 <- c(206, 193, 192, 188, 207, 210, 205, 185, 194, 187, 189, 178)
form2 <- c(177, 176, 198, 197, 185, 188, 206, 200, 189, 201, 197, 203)
qnorm(form1)
qqnorm(form1)
qqnorm(form2)
qqnorm(form1)
qqline(form1)
qqnorm(form2)
qqline(form2)
?var
mean_f1 <- mean(form1)
mean_f2 <- mean(form2)
var_f1 <- var(form1)
var_f2 <- var(form2)
a <- qqnorm(form1)
b <- qqline(form1)
c <- qqnorm(form2)
d <- qqline(form2)
plot(a,b,c,d)
?plot
a <- qqnorm(form1)
b <- qqline(form1)
par(new=T)
c <- qqnorm(form2)
d <- qqline(form2)
a <- qqnorm(form1, pch = 16)
b <- qqline(form1)
par(new=T)
c <- qqnorm(form2, pch = 17)
d <- qqline(form2)
range(form1,form2)
vlmts=range(form1,form2)
a <- qqnorm(form1, ylim=vlmts, pch = 16)
b <- qqline(form1)
par(new=T)
c <- qqnorm(form2, ylim=vlmts, pch = 17)
d <- qqline(form2)
vlmts=range(form1,form2)
a <- qqnorm(form1, ylim=vlmts, pch = 16, fill='blue')
b <- qqline(form1, lty=1)
par(new=T)
c <- qqnorm(form2, ylim=vlmts, pch = 17, fill='red')
d <- qqline(form2, lty=3)
vlmts=range(form1,form2)
a <- qqnorm(form1, ylim=vlmts, pch = 16, color='blue')
b <- qqline(form1, lty=1)
par(new=T)
c <- qqnorm(form2, ylim=vlmts, pch = 17, color='red')
d <- qqline(form2, lty=3)
vlmts=range(form1,form2)
a <- qqnorm(form1, ylim=vlmts, pch = 16, col='blue')
b <- qqline(form1, lty=1)
par(new=T)
c <- qqnorm(form2, ylim=vlmts, pch = 17, col='red')
d <- qqline(form2, lty=3)
n <- 12
s_pooled <- ( (n-1)*var_f1 + (n-1)*var_f2 ) / (2n-2)
s_pooled <- ( (n-1)*var_f1 + (n-1)*var_f2 ) / (2*n-2)
sqrt(s_pooled)
t = (mean_f1 - mean_f2) / sqrt(s_pooled*(2/n))
pt(t, 2*n-2)
machine1 <- c(16.03, 16.01, 16.04, 15.96, 16.05, 15.98, 16.05, 16.02, 16.02, 15.99)
machine2 <- c(16.02, 16.03, 15.97, 16.04, 15.96, 16.02, 16.01, 16.01, 15.99, 16.00)
machine1 <- c(16.03, 16.01, 16.04, 15.96, 16.05, 15.98, 16.05, 16.02, 16.02, 15.99)
machine2 <- c(16.02, 16.03, 15.97, 16.04, 15.96, 16.02, 16.01, 16.01, 15.99, 16.00)
n <- 10
mean_m1 <- mean(machine1)
mean_m2 <- mean(machine2)
var_m1 <- var(machine1)
var_m2 <- var(machine2)
s_pooled <- ( (n-1)*var_m1 (n-1)*var_m2 )  / (2*n-2)
t2 <-  (mean_m1 - mean_m2) / sqrt(s_pooled*(2/n))
pt(t2, 2*n-2)
machine1 <- c(16.03, 16.01, 16.04, 15.96, 16.05, 15.98, 16.05, 16.02, 16.02, 15.99)
machine2 <- c(16.02, 16.03, 15.97, 16.04, 15.96, 16.02, 16.01, 16.01, 15.99, 16.00)
n <- 10
mean_m1 <- mean(machine1)
mean_m2 <- mean(machine2)
var_m1 <- var(machine1)
var_m2 <- var(machine2)
s_pooled <- ( (n-1)*var_m1 + (n-1)*var_m2 )  / (2*n-2)
t2 <-  (mean_m1 - mean_m2) / sqrt(s_pooled*(2/n))
pt(t2, 2*n-2)
library(xlxs)
install.packages("readxl")
library(readxl)
getwd()
setwd("/home/earle/vmshare/ucla/classes/stats101b/")
read_excel("book_example_hw_dataset.xlsx")
a <- read_excel("book_example_hw_dataset.xlsx")
a
pairs <- 1:10
Birth_order1 <- c(6.08, 6.22, 7.99, 7.44, 6.48, 7.99, 6.32, 7.60, 6.03, 7.52)
Birth_order2 <- c(5.73, 5.80, 8.42, 6.84, 6.43, 8.76, 6.32, 7.62, 6.59, 7.67)
df <- data.frame(c(pairs, Birth_order1, Birth_order2))
df
df <- data.frame(pairs, Birth_order1, Birth_order2)
df
qqnorm(df$Birth_order1)
qqline(df$Birth_order1)
qqnorm(df$Birth_order1-df$Birth_order2)
qqline(df$Birth_order1-df$Birth_order2)
mean_b1 <- mean(df$Birth_order1)
mean_b2 <- mean(df$Birth_order2)
var_b1 <- var(df$Birth_order1)
var_b2 <- var(df$Birth_order2)
pt(0.975,24)
warning()
warnings()
pt(0.975,24)
pt(0.975,24)
qt(0.975,24)
qt(0.975,18)
qt(0.975,18)
qt(0.975,38)
pt(-6.44,38)
machine1 <- c(16.03, 16.01, 16.04, 15.96, 16.05, 15.98, 16.05, 16.02, 16.02, 15.99)
machine2 <- c(16.02, 16.03, 15.97, 16.04, 15.96, 16.02, 16.01, 16.01, 15.99, 16.00)
n <- 10
mean_m1 <- mean(machine1)
mean_m2 <- mean(machine2)
z <- (mean_m1 - mean_m2) / sqrt( (0.015)^2/n + (0.018)^2/n )
pt(1.35)
pnorm
pnorm(1.35)
lb <- 0.01 - 1.96 * sqrt(((0.015)^2 + (0.018)^2 ) / 10)
ub <- 0.01 + 1.96 * sqrt(((0.015)^2 + (0.018)^2 ) / 10)
c(lb,ub)
pairs <- 1:10
Birth_order1 <- c(6.08, 6.22, 7.99, 7.44, 6.48, 7.99, 6.32, 7.60, 6.03, 7.52)
Birth_order2 <- c(5.73, 5.80, 8.42, 6.84, 6.43, 8.76, 6.32, 7.62, 6.59, 7.67)
df <- data.frame(pairs, Birth_order1, Birth_order2)
qqnorm(df$Birth_order1-df$Birth_order2)
qqline(df$Birth_order1-df$Birth_order2)
qt(0.975, 18)
mean_b1 <- mean(df$Birth_order1)
mean_b2 <- mean(df$Birth_order2)
var_b1 <- var(df$Birth_order1)
var_b2 <- var(df$Birth_order2)
s_pooled <- ( 9*var_b1 + 9*var_b2 ) / (2*10-2)
lb <- (mean_b1-mean_b2) - qt(0.975, 18)*sqrt(s_pooled*(2/10))
up <- (mean_b1-mean_b2) + qt(0.975, 18)*sqrt(s_pooled*(2/10))
c(lb,ub)
mean_b1-mean_b2
?qqnorm
qqnorm(form1, pch = 16, col='blue', main = "Formulation 1 Normal Q-Q Plot")
qqline(form1, lty=1)
form1 <- c(206, 193, 192, 188, 207, 210, 205, 185, 194, 187, 189, 178)
form2 <- c(177, 176, 198, 197, 185, 188, 206, 200, 189, 201, 197, 203)
qqnorm(form1, pch = 16, col='blue', main = "Formulation 1 Normal Q-Q Plot")
qqline(form1, lty=1)
mean_f1 <- mean(form1)
mean_f2 <- mean(form2)
var_f1 <- var(form1)
var_f2 <- var(form2)
n <- 12
a <- ((var_f1+var_f2)/n)^2
b <- (var_f1/n)^2/(n-1) + (var_f2/n)^2/(n-1)
degrees <- a/b
t <- (mean_f1-mean_f2)/sqrt((var_f1+var_f2)/n )
t
qt(0.975, 22)
pt(t, 22)
d <- (mean_m1 - mean_m2)
lb <- d - qt(0.975, 2*n-2)*sqrt(s_pooled*(2/n))
ub <- d + qt(0.975, 2*n-2)*sqrt(s_pooled*(2/n))
c(lb, ub)
a <- ((var_f1+var_f2)/n)^2
b <- (var_f1/n)^2/(n-1) + (var_f2/n)^2/(n-1)
degrees <- a/b
t <- (mean_f1-mean_f2)/sqrt((var_f1+var_f2)/n )
t
